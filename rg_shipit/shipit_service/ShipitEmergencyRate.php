<?php
  class ShipitEmergencyRate {
    public $region_id = '';
    public $price = '';
    public $communes = array(
      410 => 13,
      436 => 8,
      437 => 13,
      438 => 3,
      424 => 13,
      439 => 4,
      440 => 5,
      68 => 6,
      338 => 7,
      441 => 6,
      178 => 10,
      27 => 4,
      367 => 7,
      6 => 2,
      383 => 7,
      442 => 5,
      400 => 2,
      254 => 13,
      32 => 5,
      221 => 11,
      289 => 15,
      12 => 3,
      166 => 10,
      159 => 10,
      1 => 1,
      443 => 6,
      405 => 14,
      444 => 4,
      445 => 13,
      446 => 14,
      447 => 14,
      448 => 3,
      449 => 7,
      765 => 11,
      364 => 7,
      416 => 9,
      450 => 1,
      451 => 6,
      452 => 9,
      384 => 7,
      453 => 8,
      454 => 10,
      334 => 7,
      180 => 48,
      58 => 6,
      427 => 15,
      167 => 10,
      455 => 11,
      456 => 6,
      350 => 10,
      457 => 8,
      458 => 5,
      459 => 11,
      365 => 7,
      460 => 12,
      16 => 3,
      245 => 13,
      22 => 4,
      335 => 7,
      461 => 14,
      399 => 3,
      462 => 13,
      463 => 8,
      54 => 6,
      464 => 9,
      2 => 1,
      465 => 15,
      8 => 2,
      466 => 10,
      401 => 2,
      37 => 5,
      160 => 10,
      467 => 4,
      468 => 11,
      469 => 1,
      201 => 11,
      470 => 10,
      471 => 13,
      472 => 5,
      473 => 2,
      474 => 4,
      69 => 6,
      46 => 6,
      475 => 3,
      253 => 13,
      476 => 6,
      74 => 6,
      477 => 13,
      126 => 9,
      478 => 10,
      296 => 7,
      479 => 5,
      297 => 7,
      480 => 15,
      481 => 13,
      270 => 13,
      385 => 7,
      24 => 4,
      482 => 5,
      483 => 5,
      127 => 9,
      484 => 10,
      485 => 12,
      107 => 8,
      486 => 13,
      487 => 10,
      386 => 7,
      148 => 10,
      282 => 14,
      179 => 48,
      184 => 48,
      488 => 5,
      108 => 8,
      387 => 7,
      220 => 11,
      489 => 10,
      255 => 13,
      490 => 12,
      491 => 8,
      366 => 7,
      492 => 3,
      181 => 48,
      246 => 13,
      279 => 14,
      84 => 8,
      493 => 3,
      388 => 7,
      494 => 1,
      182 => 48,
      495 => 10,
      183 => 48,
      85 => 8,
      139 => 9,
      9 => 2,
      330 => 7,
      496 => 10,
      497 => 2,
      222 => 11,
      86 => 8,
      41 => 5,
      498 => 11,
      499 => 4,
      146 => 10,
      298 => 7,
      47 => 6,
      117 => 9,
      161 => 10,
      21 => 4,
      31 => 5,
      147 => 10,
      233 => 12,
      500 => 1,
      501 => 8,
      274 => 14,
      502 => 12,
      503 => 9,
      389 => 7,
      504 => 9,
      505 => 8,
      202 => 11,
      506 => 5,
      223 => 11,
      339 => 7,
      256 => 13,
      162 => 10,
      507 => 9,
      203 => 11,
      412 => 6,
      118 => 9,
      129 => 9,
      390 => 6,
      508 => 12,
      509 => 1,
      257 => 13,
      510 => 13,
      511 => 10,
      25 => 4,
      512 => 5,
      87 => 8,
      513 => 9,
      514 => 6,
      299 => 7,
      391 => 7,
      185 => 48,
      423 => 10,
      515 => 8,
      516 => 7,
      517 => 5,
      368 => 7,
      518 => 8,
      392 => 7,
      519 => 6,
      393 => 7,
      520 => 5,
      343 => 7,
      521 => 7,
      522 => 5,
      523 => 5,
      70 => 6,
      348 => 4,
      524 => 6,
      525 => 6,
      71 => 6,
      526 => 5,
      527 => 5,
      119 => 9,
      528 => 13,
      529 => 13,
      224 => 11,
      530 => 1,
      300 => 7,
      531 => 4,
      532 => 7,
      428 => 10,
      204 => 11,
      28 => 4,
      247 => 13,
      248 => 13,
      764 => 3,
      271 => 13,
      241 => 12,
      533 => 5,
      205 => 11,
      4 => 1,
      206 => 11,
      88 => 8,
      534 => 14,
      278 => 14,
      535 => 9,
      536 => 5,
      537 => 5,
      538 => 13,
      539 => 6,
      394 => 7,
      540 => 5,
      64 => 6,
      541 => 6,
      542 => 5,
      543 => 3,
      356 => 13,
      544 => 7,
      272 => 13,
      130 => 9,
      157 => 10,
      545 => 10,
      150 => 10,
      546 => 5,
      10 => 2,
      29 => 4,
      301 => 7,
      547 => 13,
      548 => 12,
      369 => 7,
      549 => 5,
      550 => 10,
      551 => 13,
      552 => 5,
      553 => 11,
      36 => 5,
      554 => 9,
      302 => 7,
      5 => 2,
      344 => 7,
      52 => 6,
      555 => 6,
      556 => 12,
      557 => 2,
      558 => 9,
      48 => 6,
      395 => 7,
      559 => 4,
      572 => 11,
      347 => 6,
      560 => 8,
      561 => 5,
      303 => 7,
      65 => 6,
      101 => 8,
      304 => 7,
      242 => 12,
      275 => 14,
      305 => 7,
      370 => 7,
      285 => 15,
      573 => 6,
      574 => 6,
      562 => 2,
      33 => 5,
      168 => 10,
      563 => 5,
      575 => 13,
      406 => 14,
      57 => 6,
      564 => 5,
      331 => 7,
      234 => 12,
      565 => 3,
      566 => 7,
      567 => 7,
      306 => 7,
      568 => 5,
      576 => 10,
      307 => 7,
      577 => 8,
      569 => 8,
      587 => 3,
      578 => 5,
      89 => 8,
      425 => 5,
      426 => 5,
      308 => 7,
      579 => 6,
      580 => 6,
      581 => 5,
      30 => 5,
      582 => 8,
      583 => 5,
      584 => 5,
      585 => 10,
      586 => 6,
      371 => 7,
      570 => 14,
      571 => 2,
      240 => 12,
      207 => 11,
      158 => 10,
      588 => 13,
      589 => 6,
      590 => 11,
      131 => 9,
      80 => 6,
      591 => 5,
      592 => 13,
      138 => 9,
      372 => 7,
      593 => 11,
      594 => 2,
      595 => 10,
      102 => 8,
      75 => 6,
      596 => 5,
      250 => 13,
      597 => 13,
      598 => 12,
      407 => 6,
      309 => 7,
      396 => 7,
      310 => 7,
      109 => 8,
      374 => 7,
      599 => 8,
      208 => 11,
      140 => 9,
      601 => 7,
      375 => 7,
      225 => 11,
      602 => 9,
      311 => 7,
      163 => 10,
      53 => 6,
      165 => 10,
      603 => 10,
      604 => 5,
      235 => 12,
      605 => 11,
      606 => 8,
      607 => 7,
      608 => 6,
      249 => 13,
      609 => 9,
      610 => 5,
      226 => 11,
      38 => 5,
      151 => 10,
      373 => 7,
      600 => 9,
      227 => 11,
      90 => 8,
      312 => 7,
      236 => 12,
      611 => 13,
      376 => 7,
      313 => 7,
      421 => 6,
      612 => 11,
      91 => 8,
      377 => 7,
      613 => 2,
      614 => 13,
      615 => 6,
      616 => 6,
      103 => 8,
      20 => 3,
      340 => 7,
      237 => 12,
      618 => 6,
      120 => 9,
      251 => 13,
      619 => 13,
      620 => 12,
      13 => 3,
      621 => 14,
      209 => 11,
      337 => 7,
      622 => 10,
      623 => 5,
      624 => 10,
      625 => 2,
      132 => 9,
      626 => 1,
      627 => 10,
      628 => 15,
      629 => 5,
      630 => 6,
      42 => 5,
      631 => 5,
      92 => 8,
      169 => 10,
      170 => 10,
      632 => 10,
      633 => 13,
      110 => 8,
      404 => 8,
      171 => 10,
      634 => 12,
      635 => 12,
      186 => 48,
      636 => 10,
      187 => 48,
      637 => 14,
      638 => 9,
      66 => 6,
      380 => 7,
      378 => 7,
      639 => 10,
      640 => 13,
      210 => 11,
      314 => 7,
      429 => 15,
      93 => 8,
      357 => 8,
      430 => 3,
      81 => 6,
      263 => 13,
      40 => 5,
      641 => 1,
      345 => 7,
      211 => 11,
      431 => 5,
      238 => 12,
      336 => 7,
      642 => 4,
      273 => 13,
      432 => 8,
      643 => 13,
      644 => 5,
      645 => 5,
      646 => 10,
      239 => 12,
      647 => 9,
      76 => 6,
      648 => 3,
      59 => 6,
      649 => 12,
      105 => 8,
      650 => 13,
      141 => 9,
      651 => 13,
      652 => 5,
      315 => 7,
      121 => 9,
      653 => 8,
      128 => 9,
      188 => 48,
      654 => 6,
      346 => 7,
      316 => 7,
      122 => 9,
      152 => 10,
      112 => 8,
      212 => 11,
      60 => 6,
      655 => 13,
      94 => 8,
      11 => 2,
      656 => 5,
      658 => 6,
      659 => 5,
      352 => 8,
      100 => 8,
      657 => 13,
      660 => 11,
      661 => 10,
      189 => 48,
      328 => 7,
      662 => 5,
      213 => 11,
      113 => 8,
      418 => 6,
      414 => 6,
      663 => 1,
      664 => 10,
      397 => 7,
      398 => 7,
      665 => 8,
      190 => 48,
      666 => 6,
      290 => 15,
      7 => 2,
      291 => 15,
      317 => 7,
      667 => 13,
      668 => 13,
      49 => 6,
      214 => 11,
      318 => 7,
      669 => 10,
      670 => 13,
      327 => 7,
      671 => 8,
      672 => 13,
      673 => 8,
      674 => 14,
      675 => 5,
      676 => 14,
      677 => 15,
      413 => 14,
      277 => 14,
      678 => 11,
      244 => 13,
      293 => 15,
      264 => 13,
      679 => 15,
      680 => 14,
      252 => 13,
      681 => 5,
      682 => 15,
      114 => 8,
      43 => 5,
      284 => 15,
      683 => 5,
      684 => 13,
      687 => 15,
      685 => 10,
      686 => 6,
      688 => 10,
      689 => 12,
      258 => 13,
      228 => 11,
      265 => 13,
      77 => 6,
      3 => 1,
      266 => 13,
      690 => 14,
      691 => 5,
      259 => 13,
      260 => 13,
      692 => 5,
      261 => 13,
      693 => 11,
      694 => 13,
      695 => 11,
      172 => 10,
      696 => 12,
      319 => 7,
      697 => 5,
      698 => 3,
      173 => 10,
      191 => 48,
      62 => 6,
      79 => 6,
      699 => 10,
      262 => 13,
      96 => 8,
      320 => 7,
      700 => 6,
      50 => 6,
      192 => 48,
      701 => 10,
      702 => 10,
      703 => 10,
      83 => 8,
      704 => 10,
      193 => 48,
      705 => 8,
      133 => 9,
      417 => 9,
      706 => 12,
      321 => 7,
      707 => 5,
      363 => 6,
      229 => 11,
      322 => 7,
      97 => 8,
      98 => 8,
      142 => 9,
      708 => 10,
      55 => 6,
      709 => 6,
      710 => 6,
      711 => 12,
      712 => 12,
      243 => 12,
      123 => 9,
      44 => 5,
      283 => 14,
      267 => 13,
      286 => 15,
      713 => 12,
      134 => 9,
      714 => 8,
      716 => 10,
      715 => 11,
      379 => 7,
      215 => 11,
      135 => 9,
      717 => 6,
      39 => 5,
      718 => 7,
      67 => 6,
      333 => 7,
      194 => 48,
      124 => 9,
      56 => 6,
      195 => 48,
      73 => 6,
      106 => 8,
      354 => 8,
      381 => 7,
      287 => 10,
      196 => 48,
      143 => 9,
      323 => 7,
      329 => 7,
      719 => 13,
      268 => 13,
      720 => 5,
      721 => 7,
      722 => 5,
      324 => 7,
      197 => 48,
      269 => 13,
      723 => 9,
      18 => 3,
      153 => 10,
      433 => 7,
      724 => 6,
      125 => 9,
      325 => 7,
      174 => 10,
      725 => 6,
      175 => 10,
      726 => 10,
      115 => 8,
      154 => 10,
      78 => 6,
      727 => 7,
      295 => 7,
      72 => 6,
      434 => 8,
      728 => 10,
      729 => 8,
      14 => 3,
      730 => 3,
      731 => 1,
      732 => 5,
      733 => 1,
      734 => 5,
      408 => 2,
      342 => 7,
      116 => 9,
      155 => 10,
      15 => 3,
      735 => 5,
      736 => 10,
      200 => 11,
      136 => 9,
      216 => 11,
      23 => 4,
      737 => 5,
      738 => 1,
      435 => 7,
      292 => 15,
      164 => 11,
      739 => 3,
      19 => 3,
      217 => 11,
      156 => 10,
      402 => 5,
      740 => 8,
      294 => 15,
      281 => 14,
      741 => 5,
      230 => 11,
      198 => 48,
      742 => 10,
      743 => 10,
      744 => 11,
      745 => 13,
      746 => 10,
      747 => 10,
      176 => 10,
      748 => 5,
      232 => 12,
      382 => 7,
      26 => 4,
      749 => 7,
      750 => 14,
      45 => 6,
      751 => 10,
      137 => 9,
      231 => 11,
      35 => 5,
      218 => 11,
      144 => 9,
      82 => 6,
      752 => 8,
      753 => 14,
      754 => 14,
      755 => 14,
      756 => 10,
      757 => 14,
      758 => 9,
      219 => 11,
      759 => 13,
      760 => 10,
      51 => 6,
      761 => 1,
      326 => 7,
      145 => 9,
      177 => 10,
      199 => 48,
      762 => 13,
      61 => 6,
      763 => 10
    );


    public function __construct($region_id = '', $price = '') {
      $this->region_id = $region_id;
      $this->price = $price;
    }

    function getRegionId() {
      return $this->region_id;
    }

    function getPrice() {
      return $this->price;
    }

    function getEmergencyRates($region_id) {
      $sql = new DbQuery();
      $sql->select('*');
      $sql->from('rg_shipit_emergency_rates');
      $sql->where('c.region = '.$region_id);
      return Db::getInstance()->executeS($sql);
    }

    Function setEmergencyRates($emergencyRates) {
      $this->deleteEmergencyRates();
      foreach ($emergencyRates->configuration->rates->zones as $key => $value) {
        $this->insertEmergencyRate($key, $value);
      }
    }

    private function insertEmergencyRate($region, $price) {
      $query = 'INSERT INTO `'._DB_PREFIX_.'rg_shipit_emergency_rates` (
        `region`,
        `price`,
        `date_add`,
        `date_upd`)
        VALUES ('.$region.', '.$price.', NOW(), NOW());';
      if (Db::getInstance()->execute($query) == false) {
        return false;
      }
    }

    private function deleteEmergencyRates() {
      $query = 'DELETE FROM`'._DB_PREFIX_.'rg_shipit_emergency_rates`;';
      if (Db::getInstance()->execute($query) == false) {
        return false;
      }
    }

  }
?>
